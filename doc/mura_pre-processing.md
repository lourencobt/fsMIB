# Mura Pre-processing Explained

During the experiments conducted to prepare my thesis, it was found that the datasets derived from [MURA](https://stanfordmlgroup.github.io/competitions/mura/), without preprocessing, were highly complex and difficult to learn from due to a lack of homogeneity, particularly in the context of FSL. Aiming to increase the homogeneity of these datasets, it was decided that they would be preprocessed using a two-stage approach, focused on addressing the contrast issue.

The first stage of preprocessing involved addressing the issue of the different background and bone colors. In the [MURA](https://stanfordmlgroup.github.io/competitions/mura/)-derived datasets, the majority of the images have a black background and white bones, but there are also a number of images with a white background and black bones. To reduce this difference and make the datasets more homegeneous, these images with white backgrounds and black bones were preprocessed by computing the average value of all the pixels in the image. If the average was above 127.5 (half of the range of pixel values), it was determined that the image was primarily white and the image would be converted to its negative. While this process did not completely solve the issue, it did successfully convert the majority of the images with white backgrounds and black bones. 

The second stage of preprocessing involved applying the CLAHE transformation, which is provided by the [OpenCV library](https://opencv.org/), to equalize the contrast of the images. This transformation is an extension of histogram equalization, which adjusts the contrast of an image using its histogram. Instead of applying histogram equalization to the entire image, CLAHE divides the image into small regions called tiles, applies histogram equalization to each tile and then combines the tiles using bilinear interpolation to remove discrepancies at the tile borders. CLAHE also allows for the clipping of the highest values in the histogram to prevent noise amplification. This technique is useful when the image is represented by a narrow range of intensity values, as it distributes the intensities over the full range of pixel values.

Surprisingly, this preprocessing did not improve the results of the experiments. This possibly means that the models were able to extract the necessary features from the datasets without the need for preprocessing. Despite this, all the experiments in this work were conducted using the preprocessed versions of the MURA datasets. There are other preprocessing techniques that have been proposed as a means of improving the quality of these datasets, such as those described by Uysal et al. [2021](https://www.doi.org/10.48550/arXiv.2102.00515), Davletshina et al. [2020](https://www.doi.org/10.48550/arXiv.2001.10883) and Solovyova et al. [2020](https://doi.org/10.48550/arXiv.2008.03356), but these were not tested in this work.